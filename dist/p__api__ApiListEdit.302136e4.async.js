(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"7JQL":function(e,t,i){"use strict";i.r(t);i("y8nQ");var n=i("Vl3Y"),a=i("tJVT"),r=i("q1tI"),c=i("9kvl"),l=(i("5NDa"),i("5rEg")),s=(i("IzEo"),i("bx4M")),d=(i("14J3"),i("BMrR")),u=(i("jCWc"),i("kPKH")),o=(i("+L6B"),i("2/Rp")),j=i("k1fw"),b=(i("OaEy"),i("2fM7")),p=i("27j4"),O=i.n(p),f=(i("g9YV"),i("wCAj")),h=(i("P2fV"),i("NJEC")),x=(i("/zsF"),i("PArb")),m=(i("miYZ"),i("tsqr")),v=i("oBTY"),y=i("4+0c"),g=i("nKUr"),_=[{value:!0,title:"\u662f"},{value:!1,title:"\u5426"}],k=[{value:0,title:"String"},{value:1,title:"Date"},{value:2,title:"Number"},{value:3,title:"Bool"}],C=function(e){if(Number.isNaN(Number(e)))return e;var t=k.filter((function(t){if(t.value===Number(e))return t}));return t[0]["title"]},I=function(e){var t=e.value,i=e.onChange,n=e.api_id,c=Object(r["useState"])(!1),s=Object(a["a"])(c,2),d=s[0],u=s[1],o=Object(r["useState"])(!1),b=Object(a["a"])(o,2),p=b[0],O=b[1],I=Object(r["useState"])(!1),q=Object(a["a"])(I,2),N=q[0],L=q[1],w=Object(r["useState"])(0),A=Object(a["a"])(w,2),D=A[0],V=A[1],F=Object(r["useState"])({}),S=Object(a["a"])(F,2),E=S[0],P=S[1],K=Object(r["useState"])(t),J=Object(a["a"])(K,2),T=J[0],B=J[1];Object(r["useEffect"])((function(){N||B(t)}),[t]);var R=function(e,t){var i;return null===(i=t||T)||void 0===i?void 0:i.filter((function(t){return t.id===e}))[0]},Y=function(e,t){e.preventDefault();var i=null===T||void 0===T?void 0:T.map((function(e){return Object(j["a"])({},e)})),n=R(t,i);n&&(n.editable||(E[t]=Object(j["a"])({},n),P(E)),n.editable=!n.editable,B(i))},M=function(){var e=(null===T||void 0===T?void 0:T.map((function(e){return Object(j["a"])({},e)})))||[];e.push({api_id:n,id:"".concat(D),name:"",display_name:"",description:"",is_required:"",is_multi_value:"",data_type:"",options:"",editable:!0,isNew:!0}),V(D+1),B(e)},z=function(e){var t=null===T||void 0===T?void 0:T.filter((function(t){return t.id!==e}));B(t),i&&i(t)},Q=function(e,t,i){var n=Object(v["a"])(T),a=R(i,n);a&&(a[t]=e.target.value,B(n))},H=function(e,t,i){var n=Object(v["a"])(T),a=R(i,n);a&&(a[t]=e,B(n))},U=function(e,t){e.persist(),O(!0),setTimeout((function(){if(d)u(!1);else{var n=R(t)||{};if(!n.name||!n.display_name||""===n.is_required||""===n.is_multi_value||""===n.data_type)return m["default"].error("\u8bf7\u586b\u5199\u5b8c\u6574\u53c2\u6570\u4fe1\u606f\u3002"),e.target.focus(),void O(!1);L(!0),delete n.isNew,Y(e,t),i&&i(T),O(!1),L(!1)}}),500)},W=function(e,t){"Enter"===e.key&&U(e,t)},Z=function(e,t){u(!0),e.preventDefault();var i=Object(v["a"])(T),n=[];n=i.map((function(e){if(e.id===t&&E[t]){var i=Object(j["a"])(Object(j["a"])(Object(j["a"])({},e),E[t]),{},{editable:!1});return delete E[t],P(E),i}return e})),B(n),u(!1)},G=[{title:"\u5b57\u6bb5",dataIndex:"name",key:"name",render:function(e,t){return t.editable?Object(g["jsx"])(l["a"],{value:e,autoFocus:!0,onChange:function(e){return Q(e,"name",t.id)},onKeyPress:function(e){return W(e,t.id)},placeholder:"\u5b57\u6bb5"}):e}},{title:"\u540d\u79f0",dataIndex:"display_name",key:"display_name",render:function(e,t){return t.editable?Object(g["jsx"])(l["a"],{value:e,onChange:function(e){return Q(e,"display_name",t.id)},onKeyPress:function(e){return W(e,t.id)},placeholder:"\u540d\u79f0"}):e}},{title:"\u63cf\u8ff0",dataIndex:"description",key:"description",ellipsis:!0,render:function(e,t){return t.editable?Object(g["jsx"])(l["a"],{value:e,onChange:function(e){return Q(e,"description",t.id)},onKeyPress:function(e){return W(e,t.id)},placeholder:"\u63cf\u8ff0"}):e}},{title:"\u662f\u5426\u5fc5\u9700",dataIndex:"is_required",key:"is_required",render:function(e,t){return t.editable?Object(g["jsx"])(y["A"],{defaultValue:e,onChange:function(e){return H(e,"is_required",t.id)},placeholder:"\u662f\u5426\u652f\u6301\u591a\u503c",options:_}):e?"\u662f":"\u5426"}},{title:"\u662f\u5426\u652f\u6301\u591a\u503c",dataIndex:"is_multi_value",key:"is_multi_value",render:function(e,t){return t.editable?Object(g["jsx"])(y["A"],{defaultValue:e,onChange:function(e){return H(e,"is_multi_value",t.id)},placeholder:"\u662f\u5426\u652f\u6301\u591a\u503c",options:_}):e?"\u662f":"\u5426"}},{title:"\u6570\u636e\u7c7b\u578b",dataIndex:"data_type",key:"data_type",render:function(e,t){return t.editable?Object(g["jsx"])(y["A"],{defaultValue:e,onChange:function(e){return H(e,"data_type",t.id)},placeholder:"\u6570\u636e\u7c7b\u578b",options:k}):C(e)}},{title:"\u53c2\u6570\u53ef\u9009\u503c",dataIndex:"options",key:"options",ellipsis:!0,render:function(e,t){return t.editable?Object(g["jsx"])(l["a"],{value:e,onChange:function(e){return Q(e,"options",t.id)},onKeyPress:function(e){return W(e,t.id)},placeholder:"\u53c2\u6570\u53ef\u9009\u503c"}):e}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return t.editable&&p?null:t.editable?t.isNew?Object(g["jsxs"])("span",{children:[Object(g["jsx"])("a",{onClick:function(e){return U(e,t.id)},children:"\u6dfb\u52a0"}),Object(g["jsx"])(x["a"],{type:"vertical"}),Object(g["jsx"])(h["a"],{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return z(t.id)},children:Object(g["jsx"])("a",{children:"\u5220\u9664"})})]}):Object(g["jsxs"])("span",{children:[Object(g["jsx"])("a",{onClick:function(e){return U(e,t.id)},children:"\u4fdd\u5b58"}),Object(g["jsx"])(x["a"],{type:"vertical"}),Object(g["jsx"])("a",{onClick:function(e){return Z(e,t.id)},children:"\u53d6\u6d88"})]}):Object(g["jsxs"])("span",{children:[Object(g["jsx"])("a",{onClick:function(e){return Y(e,t.id)},children:"\u7f16\u8f91"}),Object(g["jsx"])(x["a"],{type:"vertical"}),Object(g["jsx"])(h["a"],{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return z(t.id)},children:Object(g["jsx"])("a",{children:"\u5220\u9664"})})]})}}];return Object(g["jsxs"])(g["Fragment"],{children:[Object(g["jsx"])(f["a"],{loading:p,columns:G,dataSource:T,pagination:!1,rowKey:function(e){return e.id}}),Object(g["jsx"])("a",{style:{position:"absolute",right:2,top:-60},onClick:M,children:"\u65b0\u589e"})]})},q=I,N=n["a"].Item,L=b["a"].Option,w=[{value:!0,title:"\u9690\u85cf"},{value:!1,title:"\u663e\u793a"}],A=[{value:!1,title:"\u7981\u7528"},{value:!0,title:"\u5f00\u542f"}],D={name:"\u63a5\u53e3\u540d\u79f0",category:"\u63a5\u53e3\u5206\u7c7b",http_method:"\u8bf7\u6c42\u65b9\u5f0f",uri:"\u63a5\u53e3\u5730\u5740",provider:"\u6570\u636e\u4f9b\u5e94\u5546",description:"\u63a5\u53e3\u63cf\u8ff0",is_hidden:"\u663e\u793a\u72b6\u6001",is_tryable:"\u5f00\u653e\u8bd5\u7528",order:"\u6392\u5e8f"},V=function(e){var t=e.form,i=e.params,p=e.dispatch,f=e.categoryList,h=e.apiDetailInfo,x=i.api_id,m=Object(r["useState"])(x),v=Object(a["a"])(m,2),_=v[0],k=(v[1],function(){return f&&Array.isArray(f)?f.map((function(e,t){var i=e.name;return Object(g["jsx"])(L,{value:i,children:i},t)})):null}),C=function(e){if(e&&Array.isArray(e))return e.map((function(e,t){var i=e.value,n=e.title;return Object(g["jsx"])(L,{value:i,children:n},t)}))},I=function(e){p({type:"apiList/getApiDetailInfo",payload:{api_id:e}}).then((function(e){t.setFieldsValue(e)}))},V=function(e){e.preventDefault(),p({type:"apiList/getApiOriginalInfo",payload:{api_id:x}}).then((function(e){t.setFieldsValue(e),y["s"].success("\u8bfb\u53d6\u6570\u636e\u5e93\u6570\u636e\u6210\u529f")}))};Object(r["useEffect"])((function(){I(x)}),[]);var F=function(e){return console.log(e)},S=function(e){p({type:"apiList/saveApiInfo",payload:Object(j["a"])({id:x},e)}),y["s"].success("\u6570\u636e\u4fdd\u5b58\u6210\u529f")},E=function(){c["c"].push("/api/apilist")};return Object(g["jsxs"])(n["a"],{form:t,initialValues:h,onFinish:S,onFinishFailed:F,children:[Object(g["jsx"])(s["a"],{bordered:!1,className:"api-read-func",children:Object(g["jsx"])(d["a"],{children:Object(g["jsxs"])(u["a"],{span:12,children:[Object(g["jsx"])("label",{children:"\u8bfb\u53d6\u6570\u636e"}),Object(g["jsx"])(o["a"],{type:"primary",onClick:V,children:"\u8bfb\u53d6\u6570\u636e\u5e93\u6570\u636e"})]})})}),Object(g["jsxs"])(s["a"],{title:"\u57fa\u672c\u4fe1\u606f",bordered:!1,className:"api-basic-info",children:[Object(g["jsxs"])(d["a"],{children:[Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.name,name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63a5\u53e3\u540d\u79f0"}],children:Object(g["jsx"])(l["a"],{placeholder:"\u8bf7\u8f93\u5165\u63a5\u53e3\u540d\u79f0"})})}),Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.category,name:"category",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u53e3\u5206\u7c7b"}],children:Object(g["jsx"])(b["a"],{placeholder:"\u8bf7\u9009\u62e9\u63a5\u53e3\u5206\u7c7b",children:k()})})})]}),Object(g["jsxs"])(d["a"],{children:[Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.http_method,name:"http_method",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8bf7\u6c42\u65b9\u5f0f"}],children:Object(g["jsx"])(l["a"],{placeholder:"\u8bf7\u8f93\u5165\u8bf7\u6c42\u65b9\u5f0f"})})}),Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.uri,name:"uri",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63a5\u53e3\u5730\u5740"}],children:Object(g["jsx"])(l["a"],{placeholder:"\u8bf7\u8f93\u5165\u63a5\u53e3\u5730\u5740"})})})]}),Object(g["jsx"])(d["a"],{children:Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.provider,name:"provider",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6570\u636e\u4f9b\u5e94\u5546"}],children:Object(g["jsx"])(l["a"],{placeholder:"\u8bf7\u8f93\u5165\u6570\u636e\u4f9b\u5e94\u5546"})})})}),Object(g["jsx"])(d["a"],{children:Object(g["jsx"])(u["a"],{span:24,children:Object(g["jsx"])(N,{label:D.description,name:"description",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63a5\u53e3\u63cf\u8ff0"}],children:Object(g["jsx"])(O.a,{placeholder:"\u8bf7\u8f93\u5165\u63a5\u53e3\u63cf\u8ff0",rows:4})})})})]}),Object(g["jsx"])(s["a"],{title:"\u8f93\u5165\u53c2\u6570",bordered:!1,children:Object(g["jsx"])(N,{name:"in_parameters",children:Object(g["jsx"])(q,{api_id:_})})}),Object(g["jsx"])(s["a"],{title:"\u8f93\u51fa\u53c2\u6570",bordered:!1,children:Object(g["jsx"])(N,{name:"out_parameters",children:Object(g["jsx"])(q,{api_id:_})})}),Object(g["jsxs"])(s["a"],{bordered:!1,className:"api-basic-info",children:[Object(g["jsx"])(d["a"],{children:Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.is_hidden,style:{marginTop:-52},name:"is_hidden",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u663e\u793a\u72b6\u6001"}],children:Object(g["jsx"])(b["a"],{placeholder:"\u8bf7\u9009\u62e9\u663e\u793a\u72b6\u6001",children:C(w)})})})}),Object(g["jsx"])(d["a"],{children:Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.is_tryable,name:"is_tryable",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u5f00\u653e\u8bd5\u7528"}],children:Object(g["jsx"])(b["a"],{placeholder:"\u8bf7\u9009\u62e9\u662f\u5426\u5f00\u653e\u8bd5\u7528",children:C(A)})})})}),Object(g["jsx"])(d["a"],{children:Object(g["jsx"])(u["a"],{span:12,children:Object(g["jsx"])(N,{label:D.order,name:"order",children:Object(g["jsx"])(l["a"],{})})})}),Object(g["jsxs"])(N,{style:{marginTop:40,textAlign:"center"},children:[Object(g["jsx"])(o["a"],{type:"primary",htmlType:"submit",children:"\u4fdd\u5b58"}),Object(g["jsx"])(o["a"],{style:{marginLeft:8},onClick:E,children:"\u53d6\u6d88"})]})]})]})},F=V,S=i("pn+7"),E=(i("9R+t"),function(e){var t=e.dispatch,i=e.categoryList,c=e.apiDetailInfo,l=n["a"].useForm(),s=Object(a["a"])(l,1),d=s[0],u=S["a"].getParams();return Object(r["useEffect"])((function(){t({type:"apiList/getCategoryList"})}),[]),Object(g["jsx"])(y["v"],{className:"apilist-edit",children:Object(g["jsx"])(F,{form:d,params:u,dispatch:t,categoryList:i,apiDetailInfo:c})})}),P=function(e){var t=e.apiList,i=t.categoryList,n=t.apiDetailInfo;return{categoryList:i,apiDetailInfo:n}};t["default"]=Object(c["a"])(P)(E)},"9R+t":function(e,t,i){}}]);